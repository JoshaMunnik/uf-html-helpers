var lib;(()=>{"use strict";class e{constructor(){}static getOrFail(e,t){if(t in e)return e[t];throw new Error(`Missing ${t} in object`)}static getOrFailAs(t,s){return e.getOrFail(t,s)}static get(e,t,s){return t in e?e[t]:s}static getAs(e,t,s){return t in e?e[t]:s}static set(e,t,s){t in e&&(e[t]=s)}static setOrFail(e,t,s){if(!(t in e))throw new Error(`Missing ${t} in object`);e[t]=s}static getAttachedAs(e,t,s){return t in e||(e[t]=s()),e[t]}static equalProperties(t,s,n=!1){for(let i in s)if(s.hasOwnProperty(i)){if(!t.hasOwnProperty(i))return!1;switch(typeof s[i]){case"object":if(!e.equalProperties(t[i],s[i],n))return!1;break;case"string":let r=t[i],o=s[i];if(n&&(r=r.toLowerCase(),o=o.toLowerCase()),r!==o)return!1;break;default:if(t[i]!==s[i])return!1}}return!0}static backupProperties(t,s){const n=Array.isArray(t)?[]:{};for(const i in s)if(s.hasOwnProperty(i)&&t.hasOwnProperty(i)){let r=s[i];n[i]="object"==typeof r?e.backupProperties(t[i],s[i]):t[i]}return n}static applyProperties(t,s){for(const n in s)if(s.hasOwnProperty(n)&&t.hasOwnProperty(n)){const i=s[n];"function"==typeof i?i(t,n):"object"==typeof i?e.applyProperties(t[n],s[n]):t[n]=s[n]}return t}static deepCopy(e){const t={};return Object.keys(e).forEach((s=>{const n=e[s];t[s]="object"==typeof n?this.deepCopy(n):n})),t}static contains(e,...t){return t.findIndex((t=>e.hasOwnProperty(t)))>=0}static combineObjects(t,s=!0,n="__init"){if(0===t.length)return{};const i={},r=[];return t.forEach((t=>e.copyProperties(t,i,n,r))),r.length&&e.callMethods(i,r,s?void 0:n),i}static copyProperty(e,t,s){const n=Object.getOwnPropertyDescriptor(t,e);n&&(n.get||n.set)?Object.defineProperty(s,e,n):s[e]=t[e]}static copyProperties(t,s,n,i){if(n&&!i)throw new Error("Missing separator list while a separator name was specified");Object.getOwnPropertyNames(t).forEach((r=>{n&&r===n?i.push(t[r]):e.copyProperty(r,t,s)}))}static callMethods(e,t,s){const n=()=>t.forEach((t=>t.call(e)));s?e[s]=n:n()}static instanceOf(e,t){if("function"!=typeof t)return!1;try{return e instanceof t}catch(e){return!1}}}const t="ufDisplayBackup";class s{constructor(){}static escapeHtml(e){return e.replace(/[&<>"'\n\t\r]/g,(e=>this.s_escapeHtmlMap.get(e)))}static convertToPlain(e){const t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""}static addClasses(e,t){e&&t&&t.split(" ").forEach((t=>e.classList.add(t.trim())))}static removeClasses(e,t){e&&t&&t.split(" ").forEach((t=>e.classList.remove(t.trim())))}static toggleClasses(e,t,s){e&&t&&t.split(" ").forEach((t=>e.classList.toggle(t.trim(),s)))}static addAndRemoveClasses(e,t,s){this.addClasses(e,t),this.removeClasses(e,s)}static addListener(e,t,s){const n="string"==typeof e?document.querySelector(e):e;if(null==n)return()=>{};const i=t.split(" ").filter((e=>e.trim().length>0));return i.forEach((e=>n.addEventListener(e,s))),()=>i.forEach((e=>n.removeEventListener(e,s)))}static addBodyListener(e,t,s){const n=t.split(" ").filter((e=>e.trim().length>0)),i=t=>{if(null==t.target||!(t.target instanceof HTMLElement))return;const n=t.target.closest(e);if(!n)return;const i=s(n);i instanceof Function?i(t):"handleEvent"in i&&i.handleEvent(t)};return n.forEach((e=>document.body.addEventListener(e,i,!0))),()=>n.forEach((e=>document.body.removeEventListener(e,i,!0)))}static addListeners(e,t,n){const i="string"==typeof e?document.querySelectorAll(e):e,r=[];return i.forEach((e=>r.push(s.addListener(e,t,n(e))))),()=>r.forEach((e=>e()))}static getAttribute(e,t,s=""){var n,i;return null!==(i=null===(n=e.attributes.getNamedItem(t))||void 0===n?void 0:n.value)&&void 0!==i?i:s}static get(e,t){const s="string"==typeof e?(t||document).querySelector(e):e;if(null==s)throw new Error(`Can not find element for ${e}`);return s}static getForId(e){const t=document.getElementById(e);if(null==t)throw new Error(`Can not find element for ${e}`);return t}static fadeIn(e,t=400){e.style.opacity="0",e.style.transition=`opacity ${t}ms`,setTimeout((()=>e.style.opacity="1"),0)}static fadeOut(e,t=400){e.style.opacity="1",e.style.transition=`opacity ${t}ms`,setTimeout((()=>e.style.opacity="0"),0)}static createAs(e){const t=(new DOMParser).parseFromString(e,"text/html").body.firstChild;return t.remove(),t}static empty(e){for(;e.firstChild;)e.removeChild(e.firstChild)}static getFirstParent(e,t){for(let s=e.parentElement;s;s=s.parentElement)if(s.matches(t))return s;return null}static getParents(e,t){const s=[];for(let n=e.parentElement;n;n=n.parentElement)t&&!n.matches(t)||s.push(n);return s}static show(s,n){s.style.display=null!=n?n:e.getAttachedAs(s,t,(()=>"block"))}static hide(s){e.getAttachedAs(s,t,(()=>s.style.display)),s.style.display="none"}static copyAttributes(e,t,s){const n=s||document;for(const s in t){const i=e.getAttribute(s);if(!i)continue;const r=n.querySelectorAll(t[s]);r&&r.forEach((e=>{e instanceof HTMLInputElement||e instanceof HTMLSelectElement?e.value=i:e instanceof HTMLElement&&(e.innerText=i)}))}}}s.s_escapeHtmlMap=new Map([["&","&amp;"],["<","&lt;"],[">","&gt;"],['"',"&quot;"],["'","&#039;"],["\n","<br/>"],["\t",""],["\r",""]]);class n{static get ClickEvent(){return this.s_isTouchSupported?"touchstart":"click"}static get DownEvent(){return this.s_isTouchSupported?"touchstart":"mousedown"}static get UpEvent(){return this.s_isTouchSupported?"touchend":"mouseup"}static get MoveEvent(){return this.s_isTouchSupported?"touchmove":"mousemove"}static get isTouchSupported(){return this.s_isTouchSupported}static get isAudioSupported(){return"Audio"in window}static get hasLocalStorage(){return"localStorage"in window}static get isMobileSafari(){const e=window.navigator.userAgent,t=/iPhone|iPad|iPod/i.test(e),s=/WebKit/i.test(e);return t&&s&&!/CriOS/i.test(e)}static get isIOS(){const e=window.navigator.userAgent;return/iPhone|iPad|iPod/i.test(e)&&!/IEMobile/i.test(e)}static get isAndroid(){const e=window.navigator.userAgent;return/Android/i.test(e)&&!/IEMobile/i.test(e)}static get isMobileWindows(){const e=window.navigator.userAgent;return/IEMobile/i.test(e)}static get isInternetExplorer(){const e=window.navigator.userAgent;return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}static getPageXY(e){if(e instanceof TouchEvent)if(e.touches){const t=e.touches[0];if(t)return{pageX:t.pageX,pageY:t.pageY}}else if(e.changedTouches){const t=e.changedTouches[0];if(t)return{pageX:t.pageX,pageY:t.pageY}}if(e instanceof MouseEvent)return{pageX:e.pageX,pageY:e.pageY};throw new Error("Can not determine pageX and pageY from event.")}static getParameterByName(e){e=e.replace(/\[/,"\\[").replace(/\]/,"\\]");const t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}static getCssRule(e){const t=e.toLowerCase();if(document.styleSheets)for(const e of document.styleSheets){let s,n=0;do{if(s=e.cssRules?e.cssRules[n]:e.rules[n],s&&s.selectorText.toLowerCase()===t)return s;n++}while(s)}return!1}static getIEVersion(){const e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>=0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);if(e.indexOf("Trident/")>=0){const t=e.indexOf("rv:");return parseInt(e.substring(t+3,e.indexOf(".",t)),10)}const s=e.indexOf("Edge/");return s>=0&&parseInt(e.substring(s+5,e.indexOf(".",s)),10)}static getAndroidVersion(){if(this.isAndroid){const e=navigator.userAgent.match(/Android [\d+\.]{2,5}/i);return null!==e&&e[0].replace("Android ","")}return!1}static isClicked(e,t){const s=t.target;return e===s||e.contains(s)}static animate(e,t,n){const i=s.get(e),r=e=>{e.target===i&&(i.removeEventListener("animationend",r),s.removeClasses(i,t),n&&n())};i.addEventListener("animationend",r),s.addClasses(i,t)}static transition(e,t,n){const i=s.get(e),r=e=>{e.target===i&&(i.removeEventListener("transitionend",r),n&&n())};i.addEventListener("transitionend",r),s.toggleClasses(i,t)}static getBackgroundImageUrl(e){const t=s.get(e).style.backgroundImage;if(t){const e=t.match(/^url\(["']?(.+?)["']?\)$/);return e&&e.length>1&&e[1]?e[1]:null}return null}static findParent(e,t){for(let n=s.get(e).parentElement;n;n=n.parentElement)if(t(n))return n;return null}static atBottom(e){const t=s.get(e);return t.scrollTop+t.clientHeight>=t.scrollHeight-10}static scrollToBottom(e){const t=s.get(e);t.scrollTop=t.scrollHeight}static loadImage(e,t,s){const n=new Image;return t&&n.addEventListener("load",(()=>t(n))),s&&n.addEventListener("error",(()=>s(n))),n.src=e,n}}var i,r,o,a,l,c,h;n.s_isTouchSupported=!!("ontouchstart"in window||"msMaxTouchPoints"in window.navigator||window.navigator.maxTouchPoints),function(e){e.Showing="showing",e.Visible="visible",e.Hiding="hiding",e.Hidden="hidden"}(i||(i={})),function(e){e.floater="data-uf-floater"}(r||(r={})),function(e){e.Adjacent="adjacent",e.Overlap="overlap",e.Relative="relative"}(o||(o={})),function(e){e.None="none",e.Show="show",e.Toggle="toggle"}(a||(a={})),function(e){e.None="none",e.Always="always",e.Tree="tree",e.Outside="outside"}(l||(l={})),function(e){e.None="none",e.Fade="fade",e.SlideVertical="slide-vertical",e.SlideHorizontal="slide-horizontal",e.Custom="custom"}(c||(c={}));class m{constructor(e={}){this.m_options={screenX:.5,screenY:.5,element:null,positionX:o.Adjacent,positionY:o.Overlap,floaterX:0,floaterY:0,elementX:0,elementY:0,width:null,height:null,autoShow:a.Toggle,autoHide:l.Outside,transition:c.None,inBounds:!1,content:"",onInitialized:null,onShown:null,onHidden:null,customShow:null,customHide:null,canHide:null},this.m_floaterElement=s.createAs(`<div style="overflow: hidden; position: absolute; left: 0; top: 0; pointer-events: all; z-index: 99999; visibility: hidden; width: max-content; height: max-content" ${r.floater}="1"></div>`),this.m_contentElement=s.createAs('<div style="position: relative; left: 0; top: 0; width: max-content; height: max-content"></div>'),this.m_elements=null,this.m_selectedElement=null,this.m_nextElement=null,this.m_state=i.Hidden,this.m_floaterWidth=0,this.m_floaterHeight=0,this.m_contentWidth=0,this.m_contentHeight=0,this.m_enabled=!0,this.m_removeListeners=[],this.m_removeElementListeners=[],this.m_transitionTimer=null,this.m_options=Object.assign(this.m_options,e),this.m_contentElement.append(this.m_options.content),this.m_floaterElement.append(this.m_contentElement),document.body.append(this.m_floaterElement),setTimeout((()=>{this.copyDimensions(),this.m_floaterElement.remove(),this.hideFloaterElement(),this.m_removeListeners.push(s.addListener(document,"mouseup touchend touchcancel",(e=>this.handleDocumentUp(e))),s.addListener(window,"resize",(()=>this.handleWindowResize()))),this.m_options.onInitialized&&this.m_options.onInitialized(this)}),1),this.refreshElements()}destroy(){this.destroyElements(),this.removeListeners(),this.removeElementListeners(),this.m_floaterElement.remove()}setOptions(e){this.m_options=Object.assign(this.m_options,e),this.refreshElements(),this.refreshContent()}hide(){return this.hideFloater()}show(){this.showFloater(null)}positionAndShow(e){this.setOptions({element:e}),this.show()}updatePosition(){this.visible&&this.updateFloaterPosition()}refreshContent(){this.visible&&(s.empty(this.m_contentElement),this.m_contentElement.append(this.m_options.content),setTimeout((()=>{this.copyDimensions(),this.updateFloaterPosition()})))}get visible(){return this.m_state!==i.Hidden}get enabled(){return this.m_enabled}set enabled(e){this.m_enabled=e}get width(){return this.m_options.width||this.m_floaterWidth}get height(){return this.m_options.height||this.m_floaterHeight}get contentWidth(){return this.m_contentWidth}get contentHeight(){return this.m_contentHeight}removeListeners(){this.m_removeListeners.forEach((e=>e())),this.m_removeListeners.length=0}removeElementListeners(){console.debug("removeElementListeners"),this.m_removeElementListeners.forEach((e=>e())),this.m_removeElementListeners.length=0}addElementListeners(e){s.getParents(e).forEach((e=>this.m_removeElementListeners.push(s.addListener(e,"scroll",(()=>this.handleScrolling()))))),this.m_removeElementListeners.push(s.addListener(window,"scroll",(()=>this.handleScrolling())))}showFloaterElementWithTransition(){if(this.m_options.transition===c.Custom&&this.m_options.customShow)this.m_options.customShow(this.m_floaterElement,(()=>this.handleShowDone()));else switch(this.m_options.transition){case c.Fade:this.showFloaterElementFade();break;case c.SlideVertical:this.showFloaterElementVerticalSlide();break;case c.SlideHorizontal:this.showFloaterElementHorizontalSlide();break;default:this.showFloaterElementImmediately()}}hideFloaterElementWithTransition(){if(this.m_options.transition===c.Custom&&this.m_options.customHide)this.m_options.customHide(this.m_floaterElement,(()=>this.handleHideDone()));else switch(this.m_options.transition){case c.Fade:this.hideFloaterElementFade();break;case c.SlideVertical:this.hideFloaterElementVerticalSlide();break;case c.SlideHorizontal:this.hideFloaterElementHorizontalSlide();break;default:this.hideFloaterElementImmediately()}}showFloaterElementImmediately(){this.showFloaterElement(),setTimeout((()=>this.handleShowDone()))}hideFloaterElementImmediately(){this.hideFloaterElement(),setTimeout((()=>this.handleHideDone()))}showFloaterElementFade(){this.showFloaterElement(),this.m_floaterElement.style.transition="",this.m_floaterElement.style.opacity="0",setTimeout((()=>{this.m_floaterElement.style.transition="opacity 0.15s",this.m_floaterElement.style.opacity="1"}),10),this.m_transitionTimer=setTimeout((()=>{this.handleShowDone()}),160)}hideFloaterElementFade(){this.m_floaterElement.style.transition="",this.m_floaterElement.style.opacity="1",this.m_floaterElement.style.transition="opacity 0.15s",this.m_floaterElement.style.opacity="0",this.m_transitionTimer=setTimeout((()=>{this.hideFloaterElement(),this.handleHideDone()}),150)}showFloaterElementVerticalSlide(){this.showFloaterElement(),this.m_contentElement.style.transition="",this.m_contentElement.style.translate="0 -100%",setTimeout((()=>{this.m_contentElement.style.transition="translate 0.15s",this.m_contentElement.style.translate="0 0"}),10),this.m_transitionTimer=setTimeout((()=>{this.handleShowDone()}),160)}hideFloaterElementVerticalSlide(){this.showFloaterElement(),this.m_contentElement.style.transition="",this.m_contentElement.style.translate="0 0",this.m_contentElement.style.transition="translate 0.15s",this.m_contentElement.style.translate="0 -100%",this.m_transitionTimer=setTimeout((()=>{this.handleHideDone()}),150)}showFloaterElementHorizontalSlide(){this.showFloaterElement(),this.m_contentElement.style.transition="",this.m_contentElement.style.translate="-100% 0",setTimeout((()=>{this.m_contentElement.style.transition="translate 0.15s",this.m_contentElement.style.translate="0 0"}),10),this.m_transitionTimer=setTimeout((()=>{this.handleShowDone()}),160)}hideFloaterElementHorizontalSlide(){this.showFloaterElement(),this.m_contentElement.style.transition="",this.m_contentElement.style.translate="0 0",this.m_contentElement.style.transition="translate 0.15s",this.m_contentElement.style.translate="-100% 0",this.m_transitionTimer=setTimeout((()=>{this.handleHideDone()}),150)}hideFloaterElement(){this.m_floaterElement.style.display="none"}showFloaterElement(){this.m_floaterElement.style.display="block"}updateFloaterPosition(){this.m_selectedElement?this.updatePositionForElement():this.updatePositionInDocument()}updatePositionForElement(){const e=this.m_selectedElement.getBoundingClientRect(),t=this.m_options.width||this.m_floaterWidth,s=this.m_options.height||this.m_floaterHeight,n=document.documentElement.clientWidth,i=document.documentElement.clientHeight;let r=this.getFloaterPosition(this.m_options.positionX,n,e.left,e.width,this.m_options.elementX,t,this.m_options.floaterX),o=this.getFloaterPosition(this.m_options.positionY,i,e.top,e.height,this.m_options.elementY,s,this.m_options.floaterY);this.m_options.inBounds&&(r=Math.max(0,Math.min(n-t,r)),o=Math.max(0,Math.min(i-s,o))),this.m_floaterElement.style.left=`${r}px`,this.m_floaterElement.style.top=`${o}px`,this.m_options.width&&(this.m_floaterElement.style.width=`${this.m_options.width}px`),this.m_options.height&&(this.m_floaterElement.style.height=`${this.m_options.height}px`)}getFloaterPosition(e,t,s,n,i,r,a){switch(e){case o.Overlap:return s+r>=t-10?n+s-r-i:s+i;case o.Adjacent:return s+n+r>=t-10?s-r-i:s+n+i;default:return s+n*i-r*a}}updatePositionInDocument(){const e=this.m_options.width||this.m_floaterElement.offsetWidth,t=this.m_options.height||this.m_floaterElement.offsetHeight,s=document.documentElement.clientWidth,n=document.documentElement.clientHeight;this.m_floaterElement.style.left="number"==typeof this.m_options.screenX?(s-e)*this.m_options.screenX+"px":this.m_options.screenX,this.m_floaterElement.style.top="number"==typeof this.m_options.screenY?(n-t)*this.m_options.screenY+"px":this.m_options.screenY,this.m_options.width&&(this.m_floaterElement.style.width=`${this.m_options.width}px`),this.m_options.height&&(this.m_floaterElement.style.height=`${this.m_options.height}px`)}refreshElements(){this.destroyElements(),this.m_options.element&&this.m_options.autoShow!==a.None&&(this.m_elements=Array.isArray(this.m_options.element)?this.m_options.element:[s.get(this.m_options.element)])}destroyElements(){this.m_elements&&(this.removeElementListeners(),this.m_elements=null,this.m_floaterElement&&m.s_floaterToElementMap.delete(this.m_floaterElement))}copyDimensions(){this.m_floaterWidth=this.m_floaterElement.offsetWidth,this.m_floaterHeight=this.m_floaterElement.offsetHeight,this.m_options.content instanceof HTMLElement&&(this.m_contentWidth=this.m_options.content.offsetWidth,this.m_contentHeight=this.m_options.content.offsetHeight)}showFloater(e){this.m_state!==i.Visible&&this.m_state!==i.Showing&&(this.stopTransitionTimer(),e&&(this.addElementListeners(e),this.m_selectedElement=e,m.s_floaterToElementMap.set(this.m_floaterElement,e)),this.m_floaterElement.style.visibility="hidden",this.showFloaterElement(),null==m.s_container.parentElement&&document.body.append(m.s_container),m.s_container.append(this.m_floaterElement),this.updateFloaterPosition(),this.m_floaterElement.style.visibility="visible",this.hideFloaterElement(),this.m_state=i.Showing,this.showFloaterElementWithTransition())}moveFloater(e){this.m_state===i.Visible||this.m_state===i.Showing?(this.m_nextElement=e,this.hideFloater()):this.showFloater(e)}hideFloater(e=null){return this.m_state===i.Hidden||this.m_state===i.Hiding||!(this.m_options.canHide&&!this.m_options.canHide(e))&&(this.stopTransitionTimer(),this.m_state=i.Hiding,setTimeout((()=>this.hideFloaterElementWithTransition())),!0)}isRelated(e){for(;;){const t=s.getParents(e,`[${r.floater}]`);if(0===t.length)return!1;const n=t[0];if(!m.s_floaterToElementMap.has(n))return!1;if(n===this.m_floaterElement)return!0;e=m.s_floaterToElementMap.get(n)}}findClickedElement(e){if(!this.m_elements)return null;for(const t of this.m_elements)if(n.isClicked(t,e))return t;return null}stopTransitionTimer(){this.m_transitionTimer&&(clearTimeout(this.m_transitionTimer),this.m_transitionTimer=null)}handleShowDone(){this.m_state=i.Visible,this.m_options.onShown&&this.m_options.onShown()}handleHideDone(){this.m_floaterElement.remove(),m.s_container.hasChildNodes()||m.s_container.remove(),this.m_state=i.Hidden,this.m_options.onHidden&&this.m_options.onHidden(),this.m_selectedElement&&(this.removeElementListeners(),this.m_selectedElement=null,m.s_floaterToElementMap.delete(this.m_floaterElement)),this.m_nextElement&&(this.showFloater(this.m_nextElement),this.m_nextElement=null)}handleDocumentUp(e){if(!this.m_enabled)return;const t=this.findClickedElement(e);if(t)switch(this.m_state){case i.Hidden:case i.Hiding:return void this.showFloater(t);case i.Visible:case i.Showing:return void(t==this.m_selectedElement?this.m_options.autoShow===a.Toggle&&this.hideFloater(e):this.moveFloater(t))}this.m_state===i.Hidden||this.m_options.autoHide!==l.Always&&(this.m_options.autoHide!==l.Outside||n.isClicked(this.m_floaterElement,e)||null!=this.m_selectedElement&&n.isClicked(this.m_selectedElement,e))&&(this.m_options.autoHide!==l.Tree||this.isRelated(e.target))||this.hideFloater(e)}handleWindowResize(){this.m_state!=i.Hidden&&this.updateFloaterPosition()}handleScrolling(){this.m_state!=i.Hidden&&this.updateFloaterPosition()}}m.s_container=s.createAs('<div style="position: fixed; top: 0; left: 0; pointer-events: none;"></div>'),m.s_floaterToElementMap=new Map,function(e){e.dataOver="data-uf-over",e.dataDisabled="data-uf-disabled"}(h||(h={}));var u;!function(e){e.Idle="Idle",e.Preloading="Preloading",e.Preloaded="Preloaded",e.Loading="Loading",e.Playing="Playing",e.Stopped="Stopped"}(u||(u={}));class d{constructor(){}static get(e){return e?e instanceof jQuery?e:$(e):e}static addEventNamespace(e,t){return e.split(" ").map((e=>e.indexOf(t)<0?e+"."+t:e)).join(" ")}}class g{constructor(e,t,s){this.m_valid=!0,this.m_visual={normalClass:"",errorClass:"",errorElements:[],hideElements:[],updateCallback:null,dependentProperties:[]},this.m_ignoreDataChange=!1,this.m_removeListeners=[],this.m_element=e,this.m_visual=Object.assign(this.m_visual,t),this.m_property=s}addRemoveListenerCallback(e){this.m_removeListeners.push(e)}destroy(){this.m_removeListeners.forEach((e=>e())),this.m_removeListeners.length=0}resetBinding(){this.m_visual.normalClass&&s.addClasses(this.m_element,this.m_visual.normalClass),this.m_visual.errorClass&&s.removeClasses(this.m_element,this.m_visual.errorClass),this.m_visual.updateCallback&&this.m_visual.updateCallback(!0)}isFieldActive(){return!0}getInputValue(e){var t;switch(e.type.toLowerCase()){case"checkbox":return e.checked;case"radio":return(null===(t=document.querySelector(`input[name=${e.name}]:checked`))||void 0===t?void 0:t.value)||"";default:return e.value}}getFieldValue(){switch(this.m_element.tagName.toLowerCase()){case"input":return this.getInputValue(this.m_element);case"select":case"textarea":return this.m_element.value;default:return this.m_element.innerHTML}}setInputValue(e,t){switch(e.type.toLowerCase()){case"checkbox":e.checked=!!t;break;case"radio":const s=this.m_element.getAttribute("name");document.querySelectorAll(`input[name=${s}]`).forEach((e=>e.value=t.toString()));break;default:e.value=t.toString()}}setFieldValue(e){switch(this.m_element.tagName.toLowerCase()){case"input":this.setInputValue(this.m_element,e);break;case"select":case"textarea":this.m_element.value=e.toString();break;default:this.m_element.innerHTML=e.toString()}}updateFieldVisual(){this.m_valid?(this.m_visual.errorClass&&s.removeClasses(this.m_element,this.m_visual.errorClass),this.m_visual.normalClass&&s.addClasses(this.m_element,this.m_visual.normalClass),this.m_visual.errorElements.forEach((e=>{const t=this.getErrorVisual(e);t.properties.delete(this.m_property),0===t.properties.size&&s.hide(t.element)}))):(this.m_visual.normalClass&&s.removeClasses(this.m_element,this.m_visual.normalClass),this.m_visual.errorClass&&s.addClasses(this.m_element,this.m_visual.errorClass),this.m_visual.errorElements.forEach((e=>{const t=this.getErrorVisual(e);0===t.properties.size&&s.show(t.element),t.properties.add(this.m_property)}))),this.m_visual.updateCallback&&this.m_visual.updateCallback(this.m_valid)}hideHideElements(){this.m_visual.hideElements.forEach((e=>d.get(e).hide()))}updateValid(e){this.m_element instanceof HTMLInputElement||this.m_element instanceof HTMLSelectElement?e&&(e=this.m_element.checkValidity()):this.m_element instanceof HTMLTextAreaElement&&e&&(e=this.m_element.checkValidity()),this.m_valid=e}noDataChange(e){try{this.m_ignoreDataChange=!0,e()}finally{this.m_ignoreDataChange=!1}}static resetErrorVisuals(){g.s_errorElements.forEach((e=>{s.hide(e.element),e.properties.clear()}))}get valid(){return this.m_valid}get element(){return this.m_element}get ignoreDataChange(){return this.m_ignoreDataChange}get visual(){return this.m_visual}get property(){return this.m_property}getErrorVisual(e){const t=s.get(e);if(!g.s_errorElements.has(t)){const e={element:t,properties:new Set};return g.s_errorElements.set(t,e),e}return g.s_errorElements.get(t)}}g.s_errorElements=new Map;class p{constructor(){}static get(e,t,s){if(e.has(t))return e.get(t);const n=s();return e.set(t,n),n}}class f{constructor(){this.m_singleEvents=new Map,this.m_groupedEvents=new Map}static get instance(){return f.s_instance||(f.s_instance=new f),f.s_instance}addListenerForGroup(e,t,n,i){const r=p.get(this.m_groupedEvents,e,(()=>[])),o=s.addListener(t,n,i);r.push(o)}addListenersForGroup(e,t,n,i){const r=p.get(this.m_groupedEvents,e,(()=>[])),o=s.addListeners(t,n,i);r.push(o)}removeAllForGroup(e){if(!this.m_groupedEvents.has(e))return;const t=this.m_groupedEvents.get(e);this.m_groupedEvents.delete(e),t.forEach((e=>e()))}addSingle(e,t,n){this.removeSingle(e,t);p.get(this.m_singleEvents,e,(()=>new Map)).set(t,(()=>s.addListener(e,t,n)))}removeSingle(e,t){const s=this.m_singleEvents.get(e);if(!s)return;const n=s.get(t);n&&(n(),s.delete(t),s.size>0||this.m_singleEvents.delete(e))}}var _,E,v,y,w,b;f.s_instance=null,function(e){e.DisplayValue="data-uf-display-value",e.ShowClasses="data-uf-show-classes",e.HideClasses="data-uf-hide-classes"}(_||(_={})),function(e){e.Self="",e.Parent="_parent",e.Next="_next",e.Previous="_previous",e.Grandparent="_grandparent",e.Dialog="_dialog"}(E||(E={}));class S{constructor(){this.m_isInitialized=!1}scan(){}init(){document.addEventListener("DOMContentLoaded",(()=>this.handleDomContentLoaded()))}addSourceAndTargetElements(e,t,s,n=null,i=null,r=""){document.querySelectorAll("["+e+"]").forEach((o=>this.addSourceElement(e,o,t,s,n,i,r)))}showElement(t,n){const i=s.getAttribute(t,_.ShowClasses),r=s.getAttribute(t,_.HideClasses);if(i||r)return void s.addAndRemoveClasses(t,n?i:r,n?r:i);const o=s.getAttribute(t,_.DisplayValue,"auto");if("disabled"==o)return;const a=e.getAttachedAs(t,"UFDisplayValue",(()=>"auto"==o?t.style.display:o));t.style.display=n?a:"none"}getTargetElements(e,t){var s,n;switch(t){case E.Self:return[e];case E.Parent:return this.buildListFromOneElement(e.parentElement);case E.Next:return this.buildListFromOneElement(e.nextElementSibling);case E.Previous:return this.buildListFromOneElement(e.previousElementSibling);case E.Grandparent:return this.buildListFromOneElement(null!==(n=null===(s=e.parentElement)||void 0===s?void 0:s.parentElement)&&void 0!==n?n:null);case E.Dialog:return this.buildListFromOneElement(e.closest("dialog"));default:return[...document.querySelectorAll(t)]}}addSourceElement(e,t,n,i,r,o,a=""){const l=s.getAttribute(t,e);if(!l)return;document.querySelectorAll(l).forEach((e=>this.addTargetElement(t,e,n,i,r,o,a)))}addTargetElement(e,t,s,n,i,r,o=""){s.includes(t)||(s.push(t),i&&r&&(o?f.instance.addListenerForGroup(o,t,i,(()=>r(t))):t.addEventListener(i,(()=>r(t))))),n.add(t,e)}buildListFromOneElement(e){return e?[e]:[]}handleDomContentLoaded(){this.m_isInitialized||(this.m_isInitialized=!0,this.scan())}}!function(e){e.NoFilter="data-uf-no-filter",e.FilterTable="data-uf-filter-table",e.HeaderRow="data-uf-header-row",e.RowNoMatch="data-uf-row-no-match"}(v||(v={}));class C extends S{scan(){f.instance.removeAllForGroup(v.FilterTable);const e=document.createElement("style");e.innerHTML=`[${v.RowNoMatch}] { display: none !important; }`,document.head.appendChild(e);document.querySelectorAll("input["+v.FilterTable+"]").forEach((e=>this.initFilterInput(e)))}initFilterInput(e){const t=e.getAttribute(v.FilterTable);if(!t)return;const s=document.querySelectorAll(t);if(!s.length)return;const n=new Map;s.forEach((e=>n.set(e,this.getAllowedColumns(e)))),f.instance.addListenerForGroup(v.FilterTable,e,"input",(()=>this.applyFilter(e.value,n)))}getAllowedColumns(e){const t=[],s=e.querySelector("tr["+v.HeaderRow+"]");return s&&s.querySelectorAll("th").forEach((e=>{t.push(null==e.attributes.getNamedItem(v.NoFilter))})),t}applyFilter(e,t){const s=e.toLowerCase();t.forEach(((e,t)=>this.applyFilterToTable(t,s,e)))}applyFilterToTable(e,t,s){e.querySelectorAll("tr").forEach((e=>{if(null!=e.attributes.getNamedItem(v.HeaderRow))return;let n=!1,i=0;e.querySelectorAll("td").forEach((e=>{(i>=s.length||s[i])&&null==e.attributes.getNamedItem(v.NoFilter)&&e.textContent&&(n||(n=e.textContent.toLowerCase().indexOf(t)>=0)),i++})),n?null!=e.attributes.getNamedItem(v.RowNoMatch)&&e.attributes.removeNamedItem(v.RowNoMatch):e.attributes.setNamedItem(document.createAttribute(v.RowNoMatch))})),e.dispatchEvent(new Event(C.RowsChangedEvent))}}C.RowsChangedEvent="rowsChanged";class T{constructor(){this.m_map=new Map}add(e,t){this.m_map.has(e)||this.m_map.set(e,new Set),this.m_map.get(e).add(t)}remove(e,t){if(this.m_map.has(e)){const s=this.m_map.get(e);s.delete(t),0===s.size&&this.m_map.delete(e)}}removeValue(e){const t=this.findKey(e);t&&this.remove(t,e)}clear(){this.m_map.clear()}get(e){if(this.m_map.has(e)){const t=this.m_map.get(e);return Array.from(t)}return[]}getKeys(){return Array.from(this.m_map.keys())}has(e){return this.m_map.has(e)}hasValue(e,t){return this.m_map.has(e)&&this.m_map.get(e).has(t)}isEmpty(){return 0===this.m_map.size}findKey(e){for(const t of this.m_map.keys())if(this.hasValue(t,e))return t;return null}get keyCount(){return this.m_map.size}get valueTotalCount(){let e=0;return this.m_map.forEach((t=>e+=t.size)),e}}!function(e){e.ClickStylingSelector="data-uf-click-styling-selector",e.ClickStylingClasses="data-uf-click-styling-classes"}(y||(y={}));!function(e){e.DetailsCollapse="data-uf-details-collapse",e.DetailsExpand="data-uf-details-expand"}(w||(w={}));class A extends S{constructor(){super(...arguments),this.m_clickableElements=[],this.m_collapsableElements=new T,this.m_expandableElements=new T}scan(){super.scan(),this.clear(),this.addSourceAndTargetElements(w.DetailsCollapse,this.m_clickableElements,this.m_collapsableElements,"click",(e=>this.handleCollapseClick(e)),w.DetailsCollapse),this.addSourceAndTargetElements(w.DetailsExpand,this.m_clickableElements,this.m_expandableElements,"click",(e=>this.handleExpandClick(e)),w.DetailsCollapse)}clear(){f.instance.removeAllForGroup(w.DetailsCollapse),this.m_clickableElements.length=0,this.m_collapsableElements.clear(),this.m_expandableElements.clear()}handleCollapseClick(e){this.m_collapsableElements.has(e)&&this.m_collapsableElements.get(e).forEach((e=>e.open=!1))}handleExpandClick(e){this.m_expandableElements.has(e)&&this.m_expandableElements.get(e).forEach((e=>e.open=!0))}}!function(e){e.ShowDialog="data-uf-show-dialog"}(b||(b={}));class F extends S{scan(){f.instance.removeAllForGroup(b.ShowDialog),f.instance.addListenersForGroup(b.ShowDialog,"["+b.ShowDialog+"]","click",(e=>()=>this.handleShowDialogClick(e)))}getDialog(e){const t=s.getAttribute(e,b.ShowDialog);if(!t)return null;const n=s.get(t);return n||console.error(`Dialog not found: ${t}`),n}buildMap(e){const t={};for(let s=0;s<e.attributes.length;s++){const n=e.attributes[s].name;n.startsWith("data-uf-")||n.startsWith("data-")&&(t[n]=`[${n}]`)}return t}handleShowDialogClick(e){const t=this.getDialog(e);if(!t)return;const n=this.buildMap(e);s.copyAttributes(e,n,t),t.showModal()}}var x,H,P,k,L;!function(e){e.Type="data-uf-toggle-type",e.Property="data-uf-toggle-property",e.Selector="data-uf-toggle-selector",e.Change="data-uf-toggle-change",e.Classes="data-uf-toggle-classes",e.ClassesMatch="data-uf-toggle-classes-match",e.Condition="data-uf-toggle-condition",e.Value="data-uf-toggle-value",e.Values="data-uf-toggle-values",e.ValuesSeparator="data-uf-toggle-values-separator",e.Required="data-uf-toggle-required",e.Target="data-uf-toggle-target"}(x||(x={})),function(e){e[e.Auto=0]="Auto",e[e.Value=1]="Value",e[e.Valid=2]="Valid",e[e.Property=3]="Property"}(H||(H={})),function(e){e[e.Auto=0]="Auto",e[e.None=1]="None",e[e.Enable=2]="Enable",e[e.Visible=3]="Visible",e[e.Required=4]="Required",e[e.NotRequired=5]="NotRequired"}(P||(P={})),function(e){e[e.Any=0]="Any",e[e.All=1]="All",e[e.None=2]="None"}(k||(k={})),function(e){e[e.None=0]="None",e[e.Match=1]="Match",e[e.NoMatch=2]="NoMatch"}(L||(L={}));const N=`\n  [${x.Type}], \n  [${x.Selector}], \n  [${x.Change}], \n  [${x.Classes}], \n  [${x.ClassesMatch}], \n  [${x.Condition}]\n`;class M extends S{scan(){f.instance.removeAllForGroup(x.Type);document.querySelectorAll(N).forEach((e=>{const t=this.buildToggleData(e);t&&(t.formElements.forEach((s=>f.instance.addListenerForGroup(x.Type,s,"click keyup keydown input change",(()=>this.updateToggleElement(e,t))))),this.updateToggleElement(e,t))}))}getToggleType(e){switch(s.getAttribute(e,x.Type)){case"value":return H.Value;case"valid":return H.Valid;case"property":return H.Property;default:return H.Auto}}getToggleChange(e){switch(s.getAttribute(e,x.Change)){case"enable":return P.Enable;case"visible":return P.Visible;case"none":return P.None;case"required":return P.Required;case"not-required":return P.NotRequired;default:return P.Auto}}getToggleCondition(e){switch(s.getAttribute(e,x.Condition)){case"any":return k.Any;case"none":return k.None;default:return k.All}}getToggleRequired(e){switch(s.getAttribute(e,x.Required)){case"match":return L.Match;case"no-match":return L.NoMatch;default:return L.None}}getFormElements(e){const t=s.getAttribute(e,x.Selector)||"";if(""===t){const t=e.closest("form");return t?[t]:[]}return[...document.querySelectorAll(t)]}buildToggleData(e){const t=this.getFormElements(e);if(!t.length)return null;const n=t[0],i=n.tagName,r="FORM"===i,o="INPUT"===i&&["checkbox","radio"].includes(n.type),a="INPUT"===i&&"file"===n.type,l="IMG"===i;let c=this.getToggleType(e),h=this.getToggleChange(e);const m=this.getToggleRequired(e),u=s.getAttribute(e,x.Classes),d=s.getAttribute(e,x.ClassesMatch),g=this.getToggleCondition(e),p=s.getAttribute(e,x.Property,"checked"),f=s.getAttribute(e,x.ValuesSeparator,","),_=s.getAttribute(e,x.Values)||s.getAttribute(e,x.Value)||"",E=_.length>0?_.split(f):[];if(o&&0===E.length&&E.push("true"),h===P.Auto)if(u.length+d.length>0)h=P.None;else switch(e.tagName){case"INPUT":case"BUTTON":case"SELECT":h=P.Enable;break;default:h=P.Visible}r?c=H.Valid:c===H.Auto&&(c=o?H.Property:E.length>0||a?H.Value:H.Valid);return{type:c,property:p,change:h,cssClassesMatch:d,cssClassesNoMatch:u,condition:g,required:m,isForm:r,isImage:l,formElements:t,values:E,target:s.getAttribute(e,x.Target)}}isValidToggleTarget(t){if(t.isForm)return t.formElements[0].checkValidity();let s=t.condition!==k.Any;return t.formElements.every((n=>{let i=null,r="";switch(t.type){case H.Valid:i=n.checkValidity();break;case H.Property:r=e.getAs(n,t.property,"").toString();break;default:r=e.getAs(n,t.isImage?"src":"value","")}switch(null===i&&(i=t.values.length>0&&!t.isImage?t.values.indexOf(r)>=0:r.length>0),t.condition){case k.Any:if(i)return s=!0,!1;break;case k.All:if(!i)return s=!1,!1;break;case k.None:if(i)return s=!1,!1}return!0})),s}updateToggleElement(e,t){const s=this.isValidToggleTarget(t);this.getTargetElements(e,t.target).forEach((e=>this.updateToggleTargetElement(e,t,s)))}updateToggleTargetElement(t,n,i){switch(n.cssClassesMatch.length&&s.toggleClasses(t,n.cssClassesMatch,i),n.cssClassesNoMatch.length&&s.toggleClasses(t,n.cssClassesNoMatch,!i),n.change){case P.Enable:e.set(t,"disabled",!i);break;case P.Visible:this.showElement(t,i)}switch(n.required){case L.Match:e.set(t,"required",i);break;case L.NoMatch:e.set(t,"required",!i)}}}var I,D,O,V,q,R,z,j,G,W,U,B,X,Y;!function(e){e.ClickAction="data-uf-click-action",e.ClickTarget="data-uf-click-target",e.ClickData="data-uf-click-data"}(I||(I={})),function(e){e.RemoveFromDom="remove-from-dom",e.Hide="hide",e.Show="show",e.Toggle="toggle",e.ToggleClass="toggle-class",e.RemoveFromClass="remove-from-class",e.AddToClass="add-to-class",e.ShowModal="show-modal",e.ShowNonModal="show-non-modal",e.Close="close"}(D||(D={}));class K extends S{scan(){f.instance.removeAllForGroup(I.ClickAction);document.querySelectorAll("["+I.ClickAction+"]").forEach((e=>this.processClickableElement(e)))}processClickableElement(e){const t=s.getAttribute(e,I.ClickAction),n=s.getAttribute(e,I.ClickTarget),i=s.getAttribute(e,I.ClickData);f.instance.addListenerForGroup(I.ClickAction,e,"click",(()=>this.performAction(e,t,n,i)))}performAction(e,t,s,n){this.getTargetElements(e,s).forEach((e=>this.performActionOnElement(e,t,n)))}performActionOnElement(e,t,s){switch(t){case D.RemoveFromDom:e.remove();break;case D.Hide:this.showElement(e,!1);break;case D.Show:this.showElement(e,!0);break;case D.Toggle:this.showElement(e,"none"===e.style.display);break;case D.ToggleClass:e.classList.toggle(s);break;case D.RemoveFromClass:e.classList.remove(s);break;case D.AddToClass:e.classList.add(s);break;case D.ShowModal:e instanceof HTMLDialogElement&&e.showModal();break;case D.ShowNonModal:e instanceof HTMLDialogElement&&e.show();break;case D.Close:e instanceof HTMLDialogElement&&e.close()}}}!function(e){e.PopupContent="data-uf-popup-content",e.PopupPosition="data-uf-popup-position",e.PopupHide="data-uf-popup-hide",e.PopupTransition="data-uf-popup-transition",e.PopupDeltaX="data-uf-popup-delta-x",e.PopupDeltaY="data-uf-popup-delta-y"}(O||(O={})),function(e){e.Vertical="vertical",e.Horizontal="horizontal",e.Overlap="overlap"}(V||(V={})),function(e){e.Tree="tree",e.Always="always"}(q||(q={}));class J extends S{scan(){document.querySelectorAll("["+O.PopupContent+"]").forEach((e=>{this.initializePopup(e)}))}initializePopup(e){const t=document.querySelectorAll(e.getAttribute(O.PopupContent)),s=e.getAttribute(O.PopupHide)||q.Always,n=e.getAttribute(O.PopupPosition)||V.Horizontal,i={element:Array.from(t),autoHide:s==q.Tree?l.Tree:l.Always,content:e,transition:e.getAttribute(O.PopupTransition)||c.None,elementX:parseInt(e.getAttribute(O.PopupDeltaX)||"0"),elementY:parseInt(e.getAttribute(O.PopupDeltaY)||"0")};switch(n){case V.Vertical:i.positionX=o.Adjacent,i.positionY=o.Overlap;break;case V.Horizontal:i.positionX=o.Overlap,i.positionY=o.Adjacent;break;case V.Overlap:i.positionX=o.Overlap,i.positionY=o.Overlap}new m(i),e.removeAttribute(O.PopupContent)}}!function(e){e.SetFieldSelector="data-uf-set-field-selector",e.SetFieldValue="data-uf-set-field-value"}(R||(R={}));class Q extends S{scan(){f.instance.removeAllForGroup(R.SetFieldSelector);document.querySelectorAll("["+R.SetFieldSelector+"]").forEach((e=>this.processClickableElement(e)))}processClickableElement(e){const t=s.getAttribute(e,R.SetFieldSelector),n=s.getAttribute(e,R.SetFieldValue);if(t){const s=document.querySelectorAll(t);s.length&&f.instance.addListenerForGroup(R.SetFieldSelector,e,"click",(()=>this.changeInputElements(s,n)))}}changeInputElements(e,t){e.forEach((e=>this.changeInputElement(e,t)))}changeInputElement(e,t){switch(e.type){case"radio":case"checkbox":e.checked=["1","true","checked",1].includes(t.toLowerCase());break;default:e.value=t}e.dispatchEvent(new Event("input")),e.dispatchEvent(new Event("change"))}}class Z{setObject(e,t){this.setString(e,JSON.stringify(t))}getObject(e,t){try{return this.has(e)?JSON.parse(this.getString(e,"")):t}catch(e){return t}}setNumber(e,t){this.setString(e,""+t)}getNumber(e,t){if(this.has(e)){const s=parseFloat(this.getString(e,""));return isNaN(s)?t:s}return t}setInteger(e,t){this.setString(e,""+t)}getInteger(e,t){if(this.has(e)){const s=parseInt(this.getString(e,""),10);return isNaN(s)?t:s}return t}setBoolean(e,t){this.setString(e,t?"1":"0")}getBoolean(e,t){return this.has(e)?"1"===this.getString(e,""):t}}class ee extends Z{setString(e,t){try{window.localStorage.setItem(e,t)}catch(e){}}getString(e,t){if(!e||0===e.length)return t;try{return window.localStorage.hasOwnProperty(e)?window.localStorage.getItem(e):t}catch(e){}return t}remove(e){try{window.localStorage.removeItem(e)}catch(e){}}has(e){try{return e in window.localStorage}catch(e){}return!1}clear(){try{window.localStorage.clear()}catch(e){}}}function te(e){switch(s.getAttribute(e,z.SortType)){case"number":return G.Number;case"text":return G.Text;case"date":return G.Date;default:return G.None}}function se(e){const t=e.attributes.getNamedItem(z.NoCaching);return null==t||"1"!=t.value}!function(e){e.Sorting="data-uf-sorting",e.SortType="data-uf-sort-type",e.SortValue="data-uf-sort-value",e.SortLocation="data-uf-sort-location",e.HeaderRow="data-uf-header-row",e.SortAscending="data-uf-sort-ascending",e.SortDescending="data-uf-sort-descending",e.StorageId="data-uf-storage-id",e.NoCaching="data-uf-no-caching"}(z||(z={})),function(e){e[e.Top=0]="Top",e[e.Middle=1]="Middle",e[e.Bottom=2]="Bottom"}(j||(j={})),function(e){e[e.None=0]="None",e[e.Number=1]="Number",e[e.Text=2]="Text",e[e.Date=3]="Date"}(G||(G={}));class ne{constructor(e){switch(this.m_columnData=[],this.m_element=e,s.getAttribute(e,z.SortLocation)){case"top":this.m_sortLocation=j.Top;break;case"bottom":this.m_sortLocation=j.Bottom;break;default:this.m_sortLocation=j.Middle}}static get(t){return e.getAttachedAs(t,"ufRowData",(()=>new ne(t)))}buildColumnData(e,t){this.m_columnData.length=0,this.m_element.querySelectorAll("td").forEach(((s,n)=>{t[n]&&se(s)?this.m_columnData.push(this.getColumnValue(s,e[n])):this.m_columnData.push((()=>this.getColumnValue(s,e[n])))}))}getColumn(e){const t=this.m_columnData[e];return"function"==typeof t?t():t}get sortLocation(){return this.m_sortLocation}getColumnValue(e,t){var s,n;const i=null!==(n=null===(s=e.attributes.getNamedItem(z.SortValue))||void 0===s?void 0:s.value)&&void 0!==n?n:e.textContent;if(null==i)return"";switch(t){case G.Date:const e=Date.parse(i.toString().trim());return isNaN(e)?0:-e;case G.Number:return parseFloat(i.toString().trim());case G.Text:return i.toString().toLowerCase().trim();default:return""}}}class ie{constructor(e){if(this.m_index=-1,this.m_descending=!0,this.m_localStorage=new ee,this.m_ascendingCssClasses=s.getAttribute(e,z.SortAscending),this.m_descendingCssClasses=s.getAttribute(e,z.SortDescending),this.m_storageKey=s.getAttribute(e,z.StorageId),this.m_storageKey&&this.m_localStorage.has(this.m_storageKey)){const e=this.m_localStorage.getObject(this.m_storageKey,{index:this.m_index,descending:this.m_descending});this.m_index=e.index,this.m_descending=e.descending}}get headerCssClasses(){return this.m_descending?this.m_descendingCssClasses:this.m_ascendingCssClasses}get index(){return this.m_index}set index(e){this.m_index=e,this.save()}get descending(){return this.m_descending}set descending(e){this.m_descending=e,this.save()}static get(t){return e.getAttachedAs(t,"ufTableSortData",(()=>new ie(t)))}save(){this.m_storageKey&&this.m_localStorage.setObject(this.m_storageKey,{index:this.m_index,descending:this.m_descending})}}class re extends S{scan(){f.instance.removeAllForGroup(z.Sorting);document.querySelectorAll(`[${z.Sorting}]`).forEach((e=>this.initTable(e)))}resort(e){this.sortTable(e)}getCompareNumberFunction(e,t){return(s,n)=>{const i=ne.get(s),r=ne.get(n);if(i.sortLocation==r.sortLocation){const s=i.getColumn(e),n=r.getColumn(e);return t?s-n:n-s}return i.sortLocation==j.Top||r.sortLocation==j.Bottom?-1:1}}getCompareTextFunction(e,t){return(s,n)=>{const i=ne.get(s),r=ne.get(n);if(i.sortLocation==r.sortLocation){const s=i.getColumn(e),n=r.getColumn(e);if(s===n)return 0;if(""===s)return t?1:-1;if(""===n)return t?-1:1;if(isNaN(s)||isNaN(n)){const e=""+s,i=""+n;return t?e.localeCompare(i):i.localeCompare(e)}return s-n}return i.sortLocation==j.Top||r.sortLocation==j.Bottom?-1:1}}getCompareFunction(e,t,s){switch(te(e)){case G.Number:return this.getCompareNumberFunction(t,s);case G.Date:return this.getCompareNumberFunction(t,!s);default:return this.getCompareTextFunction(t,s)}}getHeaderCell(e,t){const s=e.querySelector("["+z.HeaderRow+"]");if(!s)return null;const n=s.querySelectorAll("th");return n.length<=t?null:n[t]}sortRowsWithinBody(e,t){let s=null;const n=[];e.querySelectorAll("tr").forEach((e=>{e.attributes.getNamedItem(z.HeaderRow)?s=e:n.push(e)})),n.sort(t),n.forEach((t=>{s?s.nextElementSibling!=t&&t.parentElement.insertBefore(t,s.nextSibling):e.prepend(t),s=t}))}sortRowsWithinTable(e,t){let s=null;const n=[];let i=null;e.querySelectorAll("tr").forEach((e=>{e.attributes.getNamedItem(z.HeaderRow)?n.push(e):i=e})),i?(n.sort(t),s=i,n.forEach((e=>{e.parentElement.insertBefore(e,s.nextSibling),s=e}))):console.error("No header row found in table")}sortTable(e){const t=ie.get(e),s=this.getHeaderCell(e,t.index);if(!s)return;const n=this.getCompareFunction(s,t.index,t.descending),i=e.querySelector("tbody");i?this.sortRowsWithinBody(i,n):this.sortRowsWithinTable(e,n),e.dispatchEvent(new Event(re.TableSortedEvent))}initTable(e){const t=e.querySelector("["+z.HeaderRow+"]");if(!t)return;const n=ie.get(e);let i=-1;const r=[],o=[];t.querySelectorAll("th").forEach(((t,s)=>{o.push(se(t));const a=te(t);if(a!=G.None){i<0&&(i=s),n.index===s&&(i=n.index),r.push(a);const o=t.querySelector("button");o&&f.instance.addListenerForGroup(z.Sorting,o,"click",(()=>this.handleClick(e,s)))}else r.push(G.None)})),n.index=i,i<0||(e.querySelectorAll("tr").forEach((e=>ne.get(e).buildColumnData(r,o))),this.sortTable(e),s.addClasses(this.getHeaderCell(e,n.index),n.headerCssClasses))}handleClick(e,t){const n=ie.get(e);s.removeClasses(this.getHeaderCell(e,n.index),n.headerCssClasses),n.descending=n.index!=t||!n.descending,n.index=t,s.addClasses(this.getHeaderCell(e,n.index),n.headerCssClasses),this.sortTable(e)}}re.TableSortedEvent="tableSorted",function(e){e.ImagePreview="data-uf-image-preview",e.ImageName="data-uf-image-name",e.ImageWidth="data-uf-image-width",e.ImageHeight="data-uf-image-height",e.ImageSize="data-uf-image-size",e.ImageType="data-uf-image-type"}(W||(W={}));class oe extends S{constructor(){super(...arguments),this.m_inputElements=[],this.m_previewElements=new T,this.m_nameElements=new T,this.m_widthElements=new T,this.m_heightElements=new T,this.m_sizeElements=new T,this.m_typeElements=new T}scan(){this.clear(),this.addElements(),this.m_inputElements.forEach((e=>this.clearElements(e)))}clear(){f.instance.removeAllForGroup(W.ImagePreview),this.m_inputElements.length=0,this.m_heightElements.clear(),this.m_nameElements.clear(),this.m_previewElements.clear(),this.m_sizeElements.clear(),this.m_typeElements.clear(),this.m_widthElements.clear()}addElements(){this.addElement(W.ImagePreview,this.m_previewElements),this.addElement(W.ImageName,this.m_nameElements),this.addElement(W.ImageWidth,this.m_widthElements),this.addElement(W.ImageHeight,this.m_heightElements),this.addElement(W.ImageSize,this.m_sizeElements),this.addElement(W.ImageType,this.m_typeElements)}addElement(e,t){this.addSourceAndTargetElements(e,this.m_inputElements,t,"input",(e=>this.handleFileChange(e)),W.ImagePreview)}loadFile(e,t){const s=new Image;s.onload=()=>this.processFile(e,t,s),s.src=URL.createObjectURL(t)}processFile(e,t,s){this.m_previewElements.get(e).forEach((e=>e.src=s.src)),this.m_nameElements.get(e).forEach((e=>e.textContent=t.name)),this.m_widthElements.get(e).forEach((e=>e.textContent=s.width.toString())),this.m_heightElements.get(e).forEach((e=>e.textContent=s.height.toString())),this.m_sizeElements.get(e).forEach((e=>e.textContent=t.size.toString())),this.m_typeElements.get(e).forEach((e=>e.textContent=t.type))}clearElements(e){this.m_previewElements.get(e).forEach((e=>e.src="")),this.m_nameElements.get(e).forEach((e=>e.textContent="-")),this.m_widthElements.get(e).forEach((e=>e.textContent="-")),this.m_heightElements.get(e).forEach((e=>e.textContent="-")),this.m_sizeElements.get(e).forEach((e=>e.textContent="-")),this.m_typeElements.get(e).forEach((e=>e.textContent="-"))}handleFileChange(e){null!=e.files&&(e.files.length>0?this.loadFile(e,e.files[0]):this.clearElements(e))}}!function(e){e.SelectUrl="data-uf-select-url"}(U||(U={}));class ae extends S{scan(){f.instance.removeAllForGroup(U.SelectUrl);document.querySelectorAll("["+U.SelectUrl+"]").forEach((e=>f.instance.addListenerForGroup(U.SelectUrl,e,"change",(()=>this.handleSelectUrl(e)))))}handleSelectUrl(e){const t=s.getAttribute(e,U.SelectUrl);t&&(window.location.href=t.replace(/\$value\$/g,e.value))}}!function(e){e.ShareHover="data-uf-share-hover"}(B||(B={}));class le extends S{scan(){f.instance.removeAllForGroup(B.ShareHover);document.querySelectorAll("["+B.ShareHover+"]").forEach((e=>{f.instance.addListenerForGroup(B.ShareHover,e,"mouseover",(()=>this.handleShareHover(e,!0))),f.instance.addListenerForGroup(B.ShareHover,e,"mouseout",(()=>this.handleShareHover(e,!1)))}))}handleShareHover(e,t){const n=s.getAttribute(e,"href");if(!n)return;document.querySelectorAll(`[data-${B.ShareHover}][href="${n}"]`).forEach((e=>{const n=s.getAttribute(e,B.ShareHover);n&&(t?s.addClasses(e,n):s.removeClasses(e,n))}))}}!function(e){e.PageRefresh="data-uf-page-refresh"}(X||(X={}));class ce extends S{scan(){f.instance.removeAllForGroup(X.PageRefresh);document.querySelectorAll("["+X.PageRefresh+"]").forEach((e=>f.instance.addListenerForGroup(X.PageRefresh,e,"click",(()=>this.handleClick(e)))))}handleClick(e){const t=parseInt(s.getAttribute(e,X.PageRefresh));setTimeout((()=>{window.location.replace(window.location.href)}),Math.max(1,t))}}!function(e){e.ManageSubmit="data-uf-manage-submit"}(Y||(Y={}));class he extends S{scan(){f.instance.removeAllForGroup(Y.ManageSubmit);document.querySelectorAll("["+Y.ManageSubmit+"]").forEach((e=>this.addElementsListener(e.querySelectorAll("input, select, textarea"),e)))}addElementsListener(e,t){e.forEach((e=>this.addElementListener(e,t))),this.handleFormChange(t)}addElementListener(e,t){f.instance.addListenerForGroup(Y.ManageSubmit,e,"click keyup keydown input change",(()=>this.handleFormChange(t)))}setElementsDisabled(e,t){e.forEach((e=>this.setElementDisabled(e,t)))}setElementDisabled(e,t){e.disabled=t}handleFormChange(e){const t=e.checkValidity();this.setElementsDisabled(e.querySelectorAll("input[type=submit]"),!t),this.setElementsDisabled(e.querySelectorAll("button[type=submit]"),!t),this.setElementsDisabled(e.querySelectorAll("button:not([type])"),!t)}}class me extends S{constructor(){super(),this.m_helpers=[],this.registerHelper(new C),this.registerHelper(this.m_tableSortHelper=new re),this.registerHelper(new oe),this.registerHelper(new ae),this.registerHelper(new le),this.registerHelper(new ce),this.registerHelper(new he),this.registerHelper(new M),this.registerHelper(new A),this.registerHelper(new Q),this.registerHelper(new J),this.registerHelper(new K),this.registerHelper(new F)}static get instance(){return null===me.m_instance&&(me.m_instance=new me),me.m_instance}init(e=[]){e.forEach((e=>{this.registerHelper(e)})),super.init()}resort(e){this.m_tableSortHelper&&this.m_tableSortHelper.resort(e)}scan(){this.m_helpers.forEach((e=>{e.scan()}))}registerHelper(e){this.m_helpers.push(e)}}var ue,de,ge;me.m_instance=null,function(e){e[e.Contain=0]="Contain",e[e.Cover=1]="Cover",e[e.Stretch=2]="Stretch"}(ue||(ue={}));!function(e){e[e.degrees=0]="degrees",e[e.radians=1]="radians"}(de||(de={}));class pe{constructor(){}static get angleUnit(){return pe.s_angleUnit}static set angleUnit(e){pe.s_angleUnit=e}static toRadians(e){return pe.angleUnit===de.degrees?e*Math.PI/180:e}static fromRadians(e){return pe.angleUnit===de.degrees?180*e/Math.PI:e}static rotate(e,t,s,n=0,i=0){e=pe.toRadians(e);const r=t-n,o=s-i,a=Math.sin(e),l=Math.cos(e);return{x:r*l-o*a+n,y:r*a+o*l+i}}static angle(e,t,s,n){return pe.fromRadians(Math.atan2(n-t,s-e))}static distance(e,t,s,n){const i=e-s,r=t-n;return Math.sqrt(i*i+r*r)}static randomInteger(e,t){return void 0===t&&(t=e,e=0),Math.floor(e+Math.random()*(t-e+1))}static moveTo(e,t,s){return e>t?Math.min(e,t+s):Math.max(e,t-s)}static moveOverTime(e,t,s,n){return t+(e-t)*Math.max(0,Math.min(s,n))/n}static minmax(e,t,s){return Math.max(e,Math.min(t,s))}static isOverlapping(e,t,s,n,i,r,o,a){return!(e>=i+o||i>=e+s||t>=r+a||r>=t+n)}static isNumeric(e){return!Array.isArray(e)&&e-parseFloat(e)+1>=0}static getNumber(e,t){return this.isNumeric(e)?e:t}static xor(e,t){return!(!e&&!t||e&&t)}}pe.s_angleUnit=de.degrees;class fe{constructor(){}static append(e,t,s){return e.length<=0?t:t.length<=0?e:e+s+t}static escapeHtml(e){return e.replace(/[&<>"'\n\t\r]/g,(e=>this.s_escapeHtmlMap.get(e)))}static generateCode(e){let t="",s=1;for(let n=0;n<e;n++){let e;for(;e=s>2?pe.randomInteger(0,9):pe.randomInteger(0,61),0===e||24===e||1===e||47===e;);e<10?(t+=String.fromCharCode(e+48),s=0):e<36?(t+=String.fromCharCode(e+65-10),s++):(t+=String.fromCharCode(e+97-10-26),s++)}return t}static twoDigits(e){return e<10?"0"+e:e.toString()}static threeDigits(e){return("000"+e.toString()).substring(-3)}static replace(e,t){for(const[s,n]of Object.entries(t))e=e.replace(s,n);return e}static hexTwoDigits(e){return("0"+Math.min(255,Math.max(0,e)).toString(16)).substring(-2)}static hexFourDigits(e){return("000"+Math.min(65535,Math.max(0,e)).toString(16)).substring(-4)}static join(e,...t){return t.reduce(((t,s)=>(s.startsWith(e)&&(s=s.substring(e.length)),!t.endsWith(e)&&t.length&&(t+=e),t+s)))}static joinPath(...e){return this.join("/",...e)}static getOrdinalPost(e){switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}static getOrdinalNumber(e){return e.toString()+this.getOrdinalPost(e)}static asString(e,t=""){switch(e){case null:case void 0:case NaN:return t;default:return e.toString()}}static formatFileSize(e){let t;return t=e<1024?e+" bytes":e<1048576?(e/1024).toFixed(1)+" KB":e<1073741824?(e/1024/1024).toFixed(1)+" MB":(e/1024/1024/1024).toFixed(1)+" GB",t}static getFileExtension(e){const t=e.lastIndexOf("/");t>0&&(e=e.substring(t+1));const s=e.lastIndexOf(".");return!(s<0)&&e.substring(s+1).toLowerCase()}static lpad(e,t,s=" "){for(;e.length<t;)e=s+e;return e}static rpad(e,t,s=" "){for(;e.length<t;)e+=s;return e}static addParameter(e,t,s){return s&&(t=t+"="+s),t=(e.indexOf("?")>=0?"&":"?")+t,e+t}static sprintf(e,...t){const s=new RegExp("%(?!%)((?<param_index>\\d+)\\$)?(\\{(?<prop_typed>\\w+)\\})?(?<add_plus>\\+)?(?<pad_zero>0|'(?<pad_char>.))?(?<left_justify>\\-)?(?<min_size>\\d+)?(\\.(?<max_size>\\d+))?(?<format_type>\\((?<prop_text>\\w+)\\)|[bcdefFousxX])","g");let n="",i=0,r=0,o=null;for(let a=s.exec(e);null!=a;a=s.exec(e)){if(!a.groups)continue;n+=e.substring(i,a.index),i=a.index+a[0].length;let s=null;const l=a.groups.prop_text?a.groups.prop_text:a.groups.prop_typed?a.groups.prop_typed:"";let c,h=null;if(a.groups.param_index){const e=Number(a.groups.param_index);if(e>=t.length){n+="%",i=a.index+1;continue}s=t[e],h=s}else if(0===l.length||null==o){if(r>=t.length){n+="%",i=a.index+1;continue}s=t[r++]}l.length>0&&(null==h&&(null==o&&(o=s),h=o),s=h[l]),a.groups.prop_text&&(a.groups.format_type="s");let m=a.groups.min_size?Number(a.groups.min_size):-1,u=a.groups.max_size?Number(a.groups.max_size):-1;switch(a.groups.format_type){case"s":switch(s){case null:c="null";break;case void 0:c="undefined";break;default:c=s.toString()}break;case"c":c=String.fromCharCode(Number(s));break;case"b":c=Number(s).toString(2);break;case"x":c=Number(s).toString(16).toLowerCase();break;case"X":c=Number(s).toString(16).toUpperCase();break;case"u":c=Number(s).toString();break;case"d":const e=Math.floor(Number(s));c=(e>=0&&a.groups.add_plus?a.groups.add_plus:"")+e.toString();break;case"o":c=Number(s).toString(8);break;case"e":case"f":case"F":const t=Number(s);c=t>=0&&a.groups.add_plus?a.groups.add_plus:"",u<0&&(u=6),c+="e"===a.groups.format_type?t.toExponential(u):t.toFixed(u),u=-1;break;default:throw new Error('Unknown format specifier "'+a.groups.format_type+'"')}if(m>=0){const e=a.groups.pad_char?a.groups.pad_char:a.groups.pad_zero?"0":" ";c=a.groups.left_justify?fe.rpad(c,m,e):fe.lpad(c,m,e)}u>=0&&(c=c.substring(0,u)),n+=c}return n+=e.substring(i),n=n.replace(/%%/g,"%"),n}static printf(e,...t){console.log(fe.sprintf.apply(null,arguments))}}fe.s_escapeHtmlMap=new Map([["&","&amp;"],["<","&lt;"],[">","&gt;"],['"',"&quot;"],["'","&#039;"],["\n","<br/>"],["\t",""],["\r",""]]);!function(e){e.Get="GET",e.Post="POST",e.Put="PUT",e.Patch="PATCH",e.Delete="DELETE"}(ge||(ge={}));var _e;!function(e){e[e.Factory=0]="Factory",e[e.Constructor=1]="Constructor",e[e.Static=2]="Static",e[e.SingletonFactory=3]="SingletonFactory",e[e.SingletonConstructor=4]="SingletonConstructor"}(_e||(_e={}));class Ee{static registerFactory(e,t,s=[]){Ee.s_services.set(e,{type:_e.Factory,factoryProvider:t,constructorProvider:null,staticProvider:null,instance:null,services:s,factory:null})}static registerSingletonFactory(e,t,s=[]){Ee.s_services.set(e,{type:_e.SingletonFactory,factoryProvider:t,constructorProvider:null,staticProvider:null,instance:null,services:s,factory:null})}static registerConstructor(e,t,s=[]){Ee.s_services.set(e,{type:_e.Constructor,factoryProvider:null,constructorProvider:t,staticProvider:null,instance:null,services:s,factory:null})}static registerSingletonConstructor(e,t,s=[]){Ee.s_services.set(e,{type:_e.SingletonConstructor,factoryProvider:null,constructorProvider:t,staticProvider:null,instance:null,services:s,factory:null})}static registerStatic(e,t){Ee.s_services.set(e,{type:_e.Static,factoryProvider:null,constructorProvider:null,staticProvider:t,instance:null,services:[],factory:null})}static has(e){return Ee.s_services.has(e)}static getInstance(e){Ee.validateService(e);const t=Ee.s_services.get(e);switch(t.type){case _e.Constructor:return new t.constructorProvider(...Ee.getServiceInstancesFromNames(t.services));case _e.Factory:return t.factoryProvider(...Ee.getServiceInstancesFromNames(t.services));case _e.Static:return t.staticProvider;case _e.SingletonConstructor:return t.instance||(t.instance=new t.constructorProvider(...Ee.getServiceInstancesFromNames(t.services))),t.instance;case _e.SingletonFactory:return t.instance||(t.instance=t.factoryProvider(...Ee.getServiceInstancesFromNames(t.services))),t.instance}}static call(e,t){return e(...Ee.getServiceInstancesFromNames(t))}static construct(e,t){return new e(...Ee.getServiceInstancesFromNames(t))}static validateService(e){if(!Ee.has(e))throw new Error(`Can not find service: ${e}`)}static getServiceInstancesFromNames(e){return e.map((e=>e.endsWith("()")?Ee.getServiceFactory(e.slice(0,-2)):Ee.getInstance(e)))}static getServiceFactory(e){Ee.validateService(e);const t=Ee.s_services.get(e);return t.factory||(t.factory=()=>Ee.getInstance(e)),t.factory}}Ee.s_services=new Map;var ve=function(e,t,s,n){return new(s||(s=Promise))((function(i,r){function o(e){try{l(n.next(e))}catch(e){r(e)}}function a(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};class ye{constructor(){}static delay(e){return ve(this,void 0,void 0,(function*(){return new Promise((t=>setTimeout(t,e)))}))}}var we=function(e,t,s,n){return new(s||(s=Promise))((function(i,r){function o(e){try{l(n.next(e))}catch(e){r(e)}}function a(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};class be{constructor(e){this.m_element=s.get(e)}get element(){return this.m_element}show(){return we(this,void 0,void 0,(function*(){this.m_element.dispatchEvent(new Event(be.ShowStartedEvent)),yield this.performShow(),this.m_element.dispatchEvent(new Event(be.ShowDoneEvent))}))}hide(){return we(this,void 0,void 0,(function*(){this.m_element.dispatchEvent(new Event(be.HideStartedEvent)),yield this.performHide(),this.m_element.dispatchEvent(new Event(be.HideDoneEvent))}))}performShow(){return we(this,void 0,void 0,(function*(){s.fadeIn(this.element,500),yield ye.delay(500)}))}performHide(){return we(this,void 0,void 0,(function*(){s.fadeOut(this.element,500),yield ye.delay(500)}))}}be.ShowStartedEvent="uf-showable-show-started",be.ShowDoneEvent="uf-showable-show-done",be.HideStartedEvent="uf-showable-hide-started",be.HideDoneEvent="uf-showable-hide-done";me.instance.init(),lib={}})();